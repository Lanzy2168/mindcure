<view class="page-container">
  <!-- åŠ¨æ€èƒŒæ™¯å›¾ -->
  <image class="dynamic-bg" src="{{backgroundImage}}" mode="aspectFill"></image>
  <view class="bg-overlay"></view>

  <scroll-view scroll-y class="content-wrapper">
    <!-- é¡¶éƒ¨æ ‡é¢˜ -->
    <view class="header-section">
      <text class="header-title">éšå¿ƒå¾‹åŠ¨</text>
    </view>
    
    <!-- ä¸»æ’­æ”¾å¡ç‰‡ -->
    <view class="main-card">
      <image class="main-card-bg" src="{{currentTrack.cover}}" mode="aspectFill"></image>
      <view class="main-card-overlay"></view>
      <text class="main-card-title">{{currentTrack.element || currentElement.name}} å…ƒç´ </text>
    </view>
    <!-- æ–°å¢ï¼šä¸»å¡ç‰‡ä¸‹æ–¹è¿›åº¦æ¡ -->
    <view class="main-progress-bar-container">
      <text class="time-text">{{currentTime}}</text>
      <slider class="progress-slider" 
        bindchange="onSliderChange" 
        value="{{progress}}" 
        block-size="12" 
        activeColor="#fff" 
        backgroundColor="rgba(255, 255, 255, 0.2)"
      />
      <text class="time-text">{{totalTime}}</text>
    </view>

    <!-- æ’­æ”¾æ§åˆ¶ä¸å£°è½¨ -->
    <view class="controls-section">
      <!-- å£°è½¨å˜åŒ–æ¡ -->
      <view class="visualizer-container">
        <view class="visualizer-bar {{isPlaying ? 'animating' : ''}}"></view>
        <view class="visualizer-bar {{isPlaying ? 'animating' : ''}}" style="animation-delay: 0.2s;"></view>
        <view class="visualizer-bar {{isPlaying ? 'animating' : ''}}" style="animation-delay: 0.4s;"></view>
        <view class="visualizer-bar {{isPlaying ? 'animating' : ''}}" style="animation-delay: 0.1s;"></view>
        <view class="visualizer-bar {{isPlaying ? 'animating' : ''}}" style="animation-delay: 0.3s;"></view>
      </view>
      <!-- åŠŸèƒ½æŒ‰é’® -->
      <view class="action-buttons">
        <view class="action-btn" bindtap="changePlayMode">
          <image class="action-icon" src="{{playModeIcon === 'ğŸ”' ? '/images/icons/loop-all.png' : '/images/icons/loop-one.png'}}"></image>
        </view>
        <view class="action-btn main-action-btn" bindtap="togglePlay">
            <image class="action-icon large" src="{{isPlaying ? '/images/icons/pause-white.png' : '/images/icons/play-white.png'}}"></image>
        </view>
        <view class="action-btn" bindtap="replayTrack">
          <image class="action-icon" src="/images/icons/replay.png"></image>
        </view>
      </view>
    </view>

    <!-- å¯é€‰æ­Œæ›²åˆ—è¡¨ -->
    <view class="song-list-section">
      <view class="list-title">æ­Œå•ä¸“äº«</view>
      <block wx:for="{{musicTracks}}" wx:key="title">
        <view class="song-item {{currentTrack.title === item.title ? 'active' : ''}}" bindtap="selectTrack" data-track="{{item}}">
          <text class="song-title">{{item.title}}</text>
          <view wx:if="{{currentTrack.title === item.title}}" class="playing-indicator">
            <view class="playing-bar"></view>
            <view class="playing-bar" style="animation-delay: 0.2s;"></view>
            <view class="playing-bar" style="animation-delay: 0.4s;"></view>
          </view>
          <text wx:else class="song-play-icon">â–¶</text>
        </view>
      </block>
    </view>
  </scroll-view>
</view> 